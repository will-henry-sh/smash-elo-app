<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Smash Ultimate Leaderboard</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>

  <body>
    <div class="container leaderboard-container">
      <h1>Smash Ultimate Leaderboard</h1>

      <a href="/matches" class="nav-link">‚Üê Match Submission</a>

      <table>
        <tr>
          <th>Rank</th>
          <th>Player</th>
          <th>Global ELO</th>
        </tr>

        {% for player, rating, char_map in rows %}
        <tr>
          <!-- Rank -->
          <td class="rank-col">
            {% if loop.index == 1 %}
            <span class="rank-gold">{{ loop.index }}</span>
            {% elif loop.index == 2 %}
            <span class="rank-silver">{{ loop.index }}</span>
            {% elif loop.index == 3 %}
            <span class="rank-bronze">{{ loop.index }}</span>
            {% else %}
            <span class="rank-normal">{{ loop.index }}</span>
            {% endif %}
          </td>

          <!-- Player -->
          <td>
            {% if loop.index == 1 %}
            <a href="/player/{{ player }}" class="rank-gold">{{ player }}</a>
            {% elif loop.index == 2 %}
            <a href="/player/{{ player }}" class="rank-silver">{{ player }}</a>
            {% elif loop.index == 3 %}
            <a href="/player/{{ player }}" class="rank-bronze">{{ player }}</a>
            {% else %}
            <a href="/player/{{ player }}" class="rank-normal">{{ player }}</a>
            {% endif %}
          </td>

          <!-- Global ELO -->
          <td class="rating-value">{{ rating }}</td>
        </tr>
        {% endfor %}
      </table>

      <!-- RECENT MATCH SECTION (Safe even if last_match is None) -->
      {% if last_result %}
      <div class="result-box">
        <h2>Last Match Result</h2>

        <p>
          <strong>{{ last_result.p1_name }}</strong>
          ({{ last_result.p1_char }}): {{ last_result.p1_elo }}
          <span class="{{ 'green' if last_result.p1_change > 0 else 'red' }}">
            {{ last_result.p1_change }}
          </span>
        </p>

        <p>
          <strong>{{ last_result.p2_name }}</strong>
          ({{ last_result.p2_char }}): {{ last_result.p2_elo }}
          <span class="{{ 'green' if last_result.p2_change > 0 else 'red' }}">
            {{ last_result.p2_change }}
          </span>
        </p>
      </div>
      {% endif %}
    </div>
  </body>
</html>
